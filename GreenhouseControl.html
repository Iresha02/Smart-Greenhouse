<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Greenhouse Control - Smart Greenhouse System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #f8fff8 0%, #e8f5e8 100%);
            color: #2d5016;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Navigation */
        .navbar {
            background: linear-gradient(135deg, #2d5016 0%, #4a7c59 100%);
            padding: 1rem 0;
            box-shadow: 0 4px 20px rgba(45, 80, 22, 0.3);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo::before {
            content: 'üå±';
            font-size: 2rem;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-links a:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-links a.active {
            background: rgba(255, 255, 255, 0.25);
        }

        /* Main Content */
        .main-content {
            padding: 2rem 0;
        }

        .page-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .page-title {
            font-size: 2.5rem;
            color: #2d5016;
            margin-bottom: 0.5rem;
        }

        .page-subtitle {
            color: #4a7c59;
            font-size: 1.2rem;
        }

        .control-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .left-section {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .right-section {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 8px 25px rgba(45, 80, 22, 0.1);
            border: 1px solid #e8f5e8;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(45, 80, 22, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e8f5e8;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2d5016;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Control Sections */
        .control-section {
            margin-bottom: 2rem;
        }

        .control-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .control-item {
            background: linear-gradient(135deg, #f0f8f0 0%, #e8f5e8 100%);
            border-radius: 12px;
            padding: 1.5rem;
            border: 2px solid #d4edda;
            transition: all 0.3s ease;
        }

        .control-item:hover {
            transform: scale(1.02);
            border-color: #4a7c59;
        }

        .control-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .control-name {
            font-size: 1.1rem;
            font-weight: bold;
            color: #2d5016;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-status {
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-auto {
            background: #d4edda;
            color: #155724;
        }

        .status-manual {
            background: #fff3cd;
            color: #856404;
        }

        .status-off {
            background: #f8d7da;
            color: #721c24;
        }

        /* Toggle Switches */
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 1rem 0;
        }

        .toggle-label {
            font-weight: 500;
            color: #4a7c59;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            background: #ccc;
            border-radius: 15px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: #4CAF50;
        }

        .toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(30px);
        }

        /* Control Buttons */
        .control-buttons {
            display: flex;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #4a7c59;
            color: white;
        }

        .btn-primary:hover {
            background: #2d5016;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #e8f5e8;
            color: #2d5016;
        }

        .btn-secondary:hover {
            background: #d4edda;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        /* Threshold Configuration */
        .threshold-item {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid #4a7c59;
        }

        .threshold-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .threshold-name {
            font-weight: bold;
            color: #2d5016;
        }

        .threshold-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .input-group input {
            width: 80px;
            padding: 0.3rem 0.5rem;
            border: 1px solid #d4edda;
            border-radius: 4px;
            text-align: center;
        }

        .input-group label {
            font-size: 0.9rem;
            color: #4a7c59;
        }

        /* Crop Selection */
        .crop-selector {
            margin-bottom: 1.5rem;
        }

        .crop-dropdown {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #d4edda;
            border-radius: 8px;
            background: white;
            font-size: 1rem;
            color: #2d5016;
            cursor: pointer;
        }

        .crop-dropdown:focus {
            outline: none;
            border-color: #4a7c59;
        }

        .crop-settings {
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .setting-item {
            text-align: center;
        }

        .setting-label {
            font-size: 0.9rem;
            color: #4a7c59;
            margin-bottom: 0.3rem;
        }

        .setting-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #2d5016;
        }

        /* Live Indicator */
        .live-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #4CAF50;
            border-radius: 50%;
            margin-left: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .control-grid {
                grid-template-columns: 1fr;
            }

            .nav-links {
                gap: 1rem;
            }
        }

        @media (max-width: 768px) {
            .control-items {
                grid-template-columns: 1fr;
            }

            .nav-links {
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .nav-links a {
                padding: 0.3rem 0.8rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-container">
                <div class="logo">Smart Greenhouse</div>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="GreenhouseControl.html" class="active">Greenhouse Control</a></li>
                    <li><a href="reports.html">Reports</a></li>
                    <li><a href="farm_info.html">Farm Info</a></li>
                    <li><a href="#" id="settings-btn">Settings</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Settings Panel (hidden by default, appears under Settings button) -->
    <div id="settings-panel" style="display:none; position:absolute; right:40px; top:70px; z-index:2000; width:400px; max-width:90vw;">
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">‚öôÔ∏è Settings</h2>
            </div>
            <div style="padding:1rem;">
                <!-- Device Setup -->
                <h3>Device Setup</h3>
                <div>
                    <label>Add Sensor: <input type="text" id="add-sensor-input" placeholder="Sensor Name"></label>
                    <button onclick="addSensor()">Add</button>
                </div>
                <div>
                    <label>Remove Sensor:
                        <select id="remove-sensor-select"></select>
                    </label>
                    <button onclick="removeSensor()">Remove</button>
                </div>
                <hr>
                <!-- Camera Integration -->
                <h3>Camera Integration</h3>
                <label>
                    <input type="checkbox" id="camera-toggle" checked>
                    Enable Camera
                </label>
                <div>
                    <label>Snapshot Schedule:
                        <select id="snapshot-schedule">
                            <option value="5">Every 5 min</option>
                            <option value="15">Every 15 min</option>
                            <option value="30">Every 30 min</option>
                            <option value="60">Every 1 hour</option>
                        </select>
                    </label>
                </div>
                <hr>
                <!-- SCADA Connection -->
                <h3>SCADA Connection</h3>
                <label>SCADA Server IP: <input type="text" id="scada-ip" placeholder="192.168.1.100"></label>
                <button onclick="connectSCADA()">Connect</button>
                <span id="scada-status" style="margin-left:1rem; color:green;"></span>
                <hr>
                <!-- Language & Alert Preferences -->
                <h3>Language & Alert Preferences</h3>
                <label>
                    Language:
                    <select id="language-select">
                        <option value="en">English</option>
                        <option value="si">‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω</option>
                        <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
                    </select>
                </label>
                <div>
                    <label>
                        <input type="checkbox" id="alert-email" checked>
                        Email Alerts
                    </label>
                    <label style="margin-left:1rem;">
                        <input type="checkbox" id="alert-sms">
                        SMS Alerts
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <div class="main-content">
            <div class="page-header">
                <h1 class="page-title">üè† Greenhouse Control Center</h1>
                <p class="page-subtitle">Manage irrigation, lighting, ventilation, and nutrient systems</p>
            </div>

            <div class="control-grid">
                <!-- Left Section -->
                <div class="left-section">
                    <!-- System Controls -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">
                                ‚öôÔ∏è System Controls
                                <span class="live-indicator"></span>
                            </h2>
                        </div>

                        <div class="control-items">
                            <!-- Irrigation Control -->
                            <div class="control-item">
                                <div class="control-header">
                                    <div class="control-name">üíß Irrigation System</div>
                                    <div class="control-status status-auto" id="irrigation-status">AUTO</div>
                                </div>
                                <div class="toggle-container">
                                    <span class="toggle-label">Manual</span>
                                    <div class="toggle-switch" id="irrigation-toggle" onclick="toggleControl('irrigation')">
                                        <div class="toggle-slider"></div>
                                    </div>
                                    <span class="toggle-label">Auto</span>
                                </div>
                                <div class="control-buttons">
                                    <button class="btn btn-primary" onclick="activateSystem('irrigation')">Start</button>
                                    <button class="btn btn-danger" onclick="stopSystem('irrigation')">Stop</button>
                                </div>
                            </div>

                            <!-- Lighting Control -->
                            <div class="control-item">
                                <div class="control-header">
                                    <div class="control-name">üí° LED Grow Lights</div>
                                    <div class="control-status status-manual" id="lighting-status">MANUAL</div>
                                </div>
                                <div class="toggle-container">
                                    <span class="toggle-label">Manual</span>
                                    <div class="toggle-switch active" id="lighting-toggle" onclick="toggleControl('lighting')">
                                        <div class="toggle-slider"></div>
                                    </div>
                                    <span class="toggle-label">Auto</span>
                                </div>
                                <div class="control-buttons">
                                    <button class="btn btn-primary" onclick="activateSystem('lighting')">Turn On</button>
                                    <button class="btn btn-danger" onclick="stopSystem('lighting')">Turn Off</button>
                                </div>
                            </div>

                            <!-- Ventilation Control -->
                            <div class="control-item">
                                <div class="control-header">
                                    <div class="control-name">üå™Ô∏è Ventilation Fans</div>
                                    <div class="control-status status-auto" id="ventilation-status">AUTO</div>
                                </div>
                                <div class="toggle-container">
                                    <span class="toggle-label">Manual</span>
                                    <div class="toggle-switch" id="ventilation-toggle" onclick="toggleControl('ventilation')">
                                        <div class="toggle-slider"></div>
                                    </div>
                                    <span class="toggle-label">Auto</span>
                                </div>
                                <div class="control-buttons">
                                    <button class="btn btn-primary" onclick="activateSystem('ventilation')">Start</button>
                                    <button class="btn btn-danger" onclick="stopSystem('ventilation')">Stop</button>
                                </div>
                            </div>

                            <!-- Nutrient Pumps Control -->
                            <div class="control-item">
                                <div class="control-header">
                                    <div class="control-name">üß™ Nutrient Pumps</div>
                                    <div class="control-status status-off" id="nutrient-status">OFF</div>
                                </div>
                                <div class="toggle-container">
                                    <span class="toggle-label">Manual</span>
                                    <div class="toggle-switch active" id="nutrient-toggle" onclick="toggleControl('nutrient')">
                                        <div class="toggle-slider"></div>
                                    </div>
                                    <span class="toggle-label">Auto</span>
                                </div>
                                <div class="control-buttons">
                                    <button class="btn btn-primary" onclick="activateSystem('nutrient')">Activate</button>
                                    <button class="btn btn-danger" onclick="stopSystem('nutrient')">Stop</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Threshold Configuration -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">üìä Threshold Configuration</h2>
                        </div>

                        <div class="threshold-item">
                            <div class="threshold-header">
                                <div class="threshold-name">üíß Soil Moisture Irrigation</div>
                                <div class="toggle-switch" id="soil-threshold-toggle" onclick="toggleThreshold('soil')">
                                    <div class="toggle-slider"></div>
                                </div>
                            </div>
                            <div class="threshold-controls">
                                <div class="input-group">
                                    <label>When soil moisture &lt;</label>
                                    <input type="number" value="30" min="0" max="100">
                                    <label>% ‚Üí Auto Irrigation ON</label>
                                </div>
                            </div>
                        </div>

                        <div class="threshold-item">
                            <div class="threshold-header">
                                <div class="threshold-name">üå°Ô∏è Temperature Ventilation</div>
                                <div class="toggle-switch active" id="temp-threshold-toggle" onclick="toggleThreshold('temp')">
                                    <div class="toggle-slider"></div>
                                </div>
                            </div>
                            <div class="threshold-controls">
                                <div class="input-group">
                                    <label>When temperature &gt;</label>
                                    <input type="number" value="28" min="0" max="50">
                                    <label>¬∞C ‚Üí Auto Ventilation ON</label>
                                </div>
                            </div>
                        </div>

                        <div class="threshold-item">
                            <div class="threshold-header">
                                <div class="threshold-name">üí° Light Schedule</div>
                                <div class="toggle-switch active" id="light-threshold-toggle" onclick="toggleThreshold('light')">
                                    <div class="toggle-slider"></div>
                                </div>
                            </div>
                            <div class="threshold-controls">
                                <div class="input-group">
                                    <label>Daily: </label>
                                    <input type="time" value="06:00">
                                    <label>to</label>
                                    <input type="time" value="20:00">
                                </div>
                            </div>
                        </div>

                        <div class="threshold-item">
                            <div class="threshold-header">
                                <div class="threshold-name">üíß Humidity Control</div>
                                <div class="toggle-switch" id="humidity-threshold-toggle" onclick="toggleThreshold('humidity')">
                                    <div class="toggle-slider"></div>
                                </div>
                            </div>
                            <div class="threshold-controls">
                                <div class="input-group">
                                    <label>Keep humidity between</label>
                                    <input type="number" value="60" min="0" max="100">
                                    <label>% and</label>
                                    <input type="number" value="80" min="0" max="100">
                                    <label>%</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Section -->
                <div class="right-section">
                    <!-- Crop-Specific Control Settings -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">üå± Crop-Specific Settings</h2>
                        </div>

                        <div class="crop-selector">
                            <select class="crop-dropdown" id="crop-select" onchange="updateCropSettings()">
                                <option value="tomato">üçÖ Tomatoes</option>
                                <option value="lettuce">ü•¨ Lettuce</option>
                                <option value="cucumber">ü•í Cucumber</option>
                                <option value="pepper">üå∂Ô∏è Bell Peppers</option>
                                <option value="herbs">üåø Herbs (Basil/Mint)</option>
                                <option value="strawberry">üçì Strawberries</option>
                                <option value="spinach">üçÉ Spinach</option>
                            </select>
                        </div>

                        <div class="crop-settings" id="crop-settings">
                            <div class="settings-grid">
                                <div class="setting-item">
                                    <div class="setting-label">Optimal Temp</div>
                                    <div class="setting-value">22-26¬∞C</div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">Humidity</div>
                                    <div class="setting-value">65-75%</div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">Soil Moisture</div>
                                    <div class="setting-value">70-80%</div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">Light Hours</div>
                                    <div class="setting-value">14-16h</div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">pH Level</div>
                                    <div class="setting-value">6.0-6.8</div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">Nutrients</div>
                                    <div class="setting-value">High NPK</div>
                                </div>
                            </div>
                            <button class="btn btn-primary" style="width: 100%; margin-top: 1rem;" onclick="applyCropSettings()">
                                Apply Settings for Selected Crop
                            </button>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">‚ö° Quick Actions</h2>
                        </div>

                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                            <button class="btn btn-primary" onclick="emergencyStop()">üö® Emergency Stop All</button>
                            <button class="btn btn-secondary" onclick="runFullCycle()">üîÑ Run Full Water Cycle</button>
                            <button class="btn btn-secondary" onclick="testAllSystems()">üß™ Test All Systems</button>
                            <button class="btn btn-secondary" onclick="resetToDefaults()">‚öôÔ∏è Reset to Defaults</button>
                            <button class="btn btn-secondary" onclick="exportSettings()">üíæ Export Settings</button>
                        </div>
                    </div>

                    <!-- System Status -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">üìà System Status</h2>
                        </div>

                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: #f0f8f0; border-radius: 8px;">
                                <span>üîå Power Status</span>
                                <span style="color: #4CAF50; font-weight: bold;">ONLINE</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: #f0f8f0; border-radius: 8px;">
                                <span>üì° Network Connection</span>
                                <span style="color: #4CAF50; font-weight: bold;">CONNECTED</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: #f0f8f0; border-radius: 8px;">
                                <span>üîß Last Maintenance</span>
                                <span style="color: #4a7c59;">2 days ago</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: #fff3cd; border-radius: 8px;">
                                <span>‚ö†Ô∏è Active Alerts</span>
                                <span style="color: #856404; font-weight: bold;">2</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // System states
        const systemStates = {
            irrigation: { auto: true, running: false },
            lighting: { auto: false, running: true },
            ventilation: { auto: true, running: true },
            nutrient: { auto: false, running: false }
        };

        // Toggle between manual and auto control
        function toggleControl(system) {
            const toggle = document.getElementById(`${system}-toggle`);
            const status = document.getElementById(`${system}-status`);
            
            toggle.classList.toggle('active');
            systemStates[system].auto = !systemStates[system].auto;
            
            if (systemStates[system].auto) {
                status.textContent = 'AUTO';
                status.className = 'control-status status-auto';
            } else {
                status.textContent = 'MANUAL';
                status.className = 'control-status status-manual';
            }
            
            console.log(`${system} switched to ${systemStates[system].auto ? 'AUTO' : 'MANUAL'} mode`);
        }

        // Activate system
        function activateSystem(system) {
            const status = document.getElementById(`${system}-status`);
            systemStates[system].running = true;
            
            if (!systemStates[system].auto) {
                status.textContent = 'ON';
                status.className = 'control-status status-auto';
            }
            
            console.log(`${system} system activated`);
            
            // Show feedback
            showNotification(`${system.charAt(0).toUpperCase() + system.slice(1)} system started`, 'success');
        }

        // Stop system
        function stopSystem(system) {
            const status = document.getElementById(`${system}-status`);
            systemStates[system].running = false;
            
            if (!systemStates[system].auto) {
                status.textContent = 'OFF';
                status.className = 'control-status status-off';
            }
            
            console.log(`${system} system stopped`);
            
            // Show feedback
            showNotification(`${system.charAt(0).toUpperCase() + system.slice(1)} system stopped`, 'warning');
        }

        // Toggle threshold
        function toggleThreshold(type) {
            const toggle = document.getElementById(`${type}-threshold-toggle`);
            toggle.classList.toggle('active');
            
            const isActive = toggle.classList.contains('active');
            console.log(`${type} threshold ${isActive ? 'enabled' : 'disabled'}`);
            
            showNotification(`${type.charAt(0).toUpperCase() + type.slice(1)} threshold ${isActive ? 'enabled' : 'disabled'}`, 'info');
        }

        // Crop settings data
        const cropData = {
            tomato: {
                temp: '22-26¬∞C',
                humidity: '65-75%',
                soilMoisture: '70-80%',
                lightHours: '14-16h',
                ph: '6.0-6.8',
                nutrients: 'High NPK'
            },
            lettuce: {
                temp: '18-22¬∞C',
                humidity: '60-70%',
                soilMoisture: '60-70%',
                lightHours: '12-14h',
                ph: '6.0-7.0',
                nutrients: 'Medium N'
            },
            cucumber: {
                temp: '24-28¬∞C',
                humidity: '70-80%',
                soilMoisture: '75-85%',
                lightHours: '14-16h',
                ph: '5.8-6.5',
                nutrients: 'High K'
            },
            pepper: {
                temp: '25-30¬∞C',
                humidity: '60-70%',
                soilMoisture: '65-75%',
                lightHours: '14-16h',
                ph: '6.0-6.8',
                nutrients: 'Medium NPK'
            },
            herbs: {
                temp: '20-24¬∞C',
                humidity: '50-60%',
                soilMoisture: '60-70%',
                lightHours: '12-14h',
                ph: '6.0-7.5',
                nutrients: 'Low NPK'
            },
            strawberry: {
                temp: '18-24¬∞C',
                humidity: '65-75%',
                soilMoisture: '70-80%',
                lightHours: '12-16h',
                ph: '5.5-6.5',
                nutrients: 'High P'
            },
            spinach: {
                temp: '15-20¬∞C',
                humidity: '60-70%',
                soilMoisture: '65-75%',
                lightHours: '10-12h',
                ph: '6.0-7.0',
                nutrients: 'High N'
            }
        };

        // Update crop settings display
        function updateCropSettings() {
            const cropSelect = document.getElementById('crop-select');
            const selectedCrop = cropSelect.value;
            const data = cropData[selectedCrop];
            
            const settingsGrid = document.querySelector('.settings-grid');
            settingsGrid.innerHTML = `
                <div class="setting-item">
                    <div class="setting-label">Optimal Temp</div>
                    <div class="setting-value">${data.temp}</div>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Humidity</div>
                    <div class="setting-value">${data.humidity}</div>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Soil Moisture</div>
                    <div class="setting-value">${data.soilMoisture}</div>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Light Hours</div>
                    <div class="setting-value">${data.lightHours}</div>
                </div>
                <div class="setting-item">
                    <div class="setting-label">pH Level</div>
                    <div class="setting-value">${data.ph}</div>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Nutrients</div>
                    <div class="setting-value">${data.nutrients}</div>
                </div>
            `;
            
            console.log(`Updated settings for ${selectedCrop}`);
        }

        // Apply crop-specific settings
        function applyCropSettings() {
            const cropSelect = document.getElementById('crop-select');
            const selectedCrop = cropSelect.options[cropSelect.selectedIndex].text;
            
            showNotification(`Applied optimal settings for ${selectedCrop}`, 'success');
            console.log(`Applied settings for ${selectedCrop}`);
        }

        // Quick action functions
        function emergencyStop() {
            // Stop all systems
            Object.keys(systemStates).forEach(system => {
                systemStates[system].running = false;
                const status = document.getElementById(`${system}-status`);
                status.textContent = 'STOPPED';
                status.className = 'control-status status-off';
            });
            
            showNotification('üö® EMERGENCY STOP - All systems halted', 'error');
            console.log('Emergency stop activated - all systems stopped');
        }

        function runFullCycle() {
            showNotification('üîÑ Starting full irrigation cycle...', 'info');
            console.log('Running full water cycle');
            
            // Simulate cycle
            setTimeout(() => {
                showNotification('‚úÖ Full irrigation cycle completed', 'success');
            }, 3000);
        }

        function testAllSystems() {
            showNotification('üß™ Running system diagnostics...', 'info');
            console.log('Testing all systems');
            
            // Simulate testing
            setTimeout(() => {
                showNotification('‚úÖ All systems passed diagnostic test', 'success');
            }, 5000);
        }

        function resetToDefaults() {
            // Reset all toggles to default state
            systemStates.irrigation.auto = true;
            systemStates.lighting.auto = false;
            systemStates.ventilation.auto = true;
            systemStates.nutrient.auto = false;
            
            // Update UI
            document.getElementById('irrigation-toggle').classList.remove('active');
            document.getElementById('lighting-toggle').classList.add('active');
            document.getElementById('ventilation-toggle').classList.remove('active');
            document.getElementById('nutrient-toggle').classList.add('active');
            
            // Update status displays
            document.getElementById('irrigation-status').textContent = 'AUTO';
            document.getElementById('lighting-status').textContent = 'MANUAL';
            document.getElementById('ventilation-status').textContent = 'AUTO';
            document.getElementById('nutrient-status').textContent = 'MANUAL';
            
            showNotification('‚öôÔ∏è Settings reset to factory defaults', 'info');
            console.log('Settings reset to defaults');
        }

        function exportSettings() {
            const settings = {
                systemStates: systemStates,
                timestamp: new Date().toISOString(),
                cropType: document.getElementById('crop-select').value
            };
            
            // Create and download file
            const dataStr = JSON.stringify(settings, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `greenhouse-settings-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('üíæ Settings exported successfully', 'success');
            console.log('Settings exported');
        }

        // Notification system
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.style.position = 'fixed';
            notification.style.top = '100px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            notification.style.minWidth = '300px';
            notification.style.animation = 'slideIn 0.3s ease';
            
            const icons = {
                success: '‚úÖ',
                error: 'üö®',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };
            
            notification.innerHTML = `
                <span class="notification-icon">${icons[type]}</span>
                <div>${message}</div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Add CSS for notification animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Navigation functionality
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', function(e) {
                // Only prevent default for non-existing pages
                if (this.getAttribute('href') === '#') {
                    e.preventDefault();
                }
                
                // Remove active class from all links
                document.querySelectorAll('.nav-links a').forEach(l => l.classList.remove('active'));
                
                // Add active class to clicked link
                this.classList.add('active');
                
                console.log('Navigating to:', this.textContent);
            });
        });

        // Settings panel logic
        const settingsBtn = document.getElementById('settings-btn');
        const settingsPanel = document.getElementById('settings-panel');
        let sensors = ['Temperature', 'Humidity', 'Soil Moisture'];

        function updateSensorSelect() {
            const select = document.getElementById('remove-sensor-select');
            select.innerHTML = '';
            sensors.forEach(s => {
                const opt = document.createElement('option');
                opt.value = s;
                opt.textContent = s;
                select.appendChild(opt);
            });
        }
        updateSensorSelect();

        function addSensor() {
            const input = document.getElementById('add-sensor-input');
            if (input.value.trim()) {
                sensors.push(input.value.trim());
                updateSensorSelect();
                alert('Sensor added: ' + input.value.trim());
                input.value = '';
            }
        }
        function removeSensor() {
            const select = document.getElementById('remove-sensor-select');
            if (select.value) {
                sensors = sensors.filter(s => s !== select.value);
                updateSensorSelect();
                alert('Sensor removed: ' + select.value);
            }
        }
        function connectSCADA() {
            const ip = document.getElementById('scada-ip').value;
            if (ip) {
                document.getElementById('scada-status').textContent = 'Connected to ' + ip;
                document.getElementById('scada-status').style.color = 'green';
            } else {
                document.getElementById('scada-status').textContent = 'Please enter IP';
                document.getElementById('scada-status').style.color = 'red';
            }
        }

        // Show/hide settings panel under the button
        settingsBtn.addEventListener('click', function(e) {
            e.preventDefault();
            if (settingsPanel.style.display === 'none') {
                settingsPanel.style.display = 'block';
                // Position panel under the button
                const rect = settingsBtn.getBoundingClientRect();
                settingsPanel.style.top = (rect.bottom + window.scrollY + 10) + 'px';
                settingsPanel.style.right = (window.innerWidth - rect.right - 10) + 'px';
            } else {
                settingsPanel.style.display = 'none';
            }
        });

        // Hide panel if clicked outside
        document.addEventListener('click', function(e) {
            if (!settingsPanel.contains(e.target) && e.target !== settingsBtn) {
                settingsPanel.style.display = 'none';
            }
        });

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize crop settings
            updateCropSettings();
            
            // Show welcome notification
            setTimeout(() => {
                showNotification('üå± Greenhouse Control Center loaded successfully', 'success');
            }, 1000);
        });

        // Simulate real-time system monitoring
        setInterval(() => {
            // Random system updates could be added here
            // For example, automatic threshold triggers
        }, 10000);
    </script>
</body>
</html>
